<!--
title: Powershell
description: 
published: true
date: 2021-05-08T15:18:21.174Z
tags: 
editor: ckeditor
dateCreated: 2021-05-08T14:42:07.092Z
-->

<h1>Menu sous Powershell</h1>
<p>Pour faire un menu sous powershell,&nbsp;</p>
<figure class="image"><img src="/capture.png"></figure>
<p>&nbsp;</p>
<h2>principe de fonctionnement</h2>
<p>il va falloir déclarer une variable qui va servir en quelque sorte de bouton…allumé ou éteinds</p>
<p><code>$continue = $true</code></p>
<p>avec cette variable j'utilise une boucle pour permettre de laisser en permanence l'affichage</p>
<p><code>while (true)</code></p>
<p>{</p>
<p>le menu avec des write-host</p>
<p>}</p>
<p>puis il va me falloir une autre variable pour stocker mon choix avec<code> $choix = read-host “faire un choix”</code></p>
<p>suivant l'état de ce choix je sortirai de la boucle while et cela provoquera soit une action du script soit une sortie du script avec switch ($choix)</p>
<p>pour sortir du script si je fait le choix ‘x’ je passe la variable <code>$continue à false &nbsp;</code> ce qui aura pour effet d'arrêter la boucle while</p>
<p>&nbsp;</p>
<h2>aperçu d'une construction de menu</h2>
<p>$continue = $true</p>
<p>while (continue)</p>
<p>{</p>
<p>write-host “----------------------MON TITRE -----------------------”</p>
<p>write-host “1. mon action 1”</p>
<p>write-host "2. mon action2"</p>
<p>write-host"-------------------------------------------------------------------"</p>
<p>$choix = read-host “faire un choix”</p>
<p>switch ($choix)</p>
<p>{</p>
<ol>
  <li>{commande de mon action 1}</li>
  <li>{commande de mon action 2}&nbsp;</li>
</ol>
<p>‘x’ {$continue= $false}</p>
<p>default {Write-Host "Choix invalide"-ForegroundColor Red}</p>
<p>}</p>
<p>&nbsp;</p>
